<?xml version="1.0" ?>
<sdf version="1.6">
  <world name="default">
    <include>
      <uri>model://ground_plane</uri>
    </include>

    <include>
      <uri>model://sun</uri>
    </include>

    <!-- Definir um modelo simples -->
    <model name="propeller_test_model">
	  <!-- Ajustar a posição para que o modelo esteja logo acima do solo -->
	  <pose>0 0 0.5 0 0 0</pose>

	  <!-- Um link simples -->
	  <link name="base_link">
		<inertial>
		  <mass>1.0</mass>
		  <inertia>
			<ixx>0.1</ixx>
			<iyy>0.1</iyy>
			<izz>0.1</izz>
		  </inertia>
		</inertial>
		<visual name="imu_visual">
		  <pose>0 0 0 3.141593 0 0</pose>
		  <geometry>
			<box>
			  <size>0.1 0.05 0.04</size>
			</box>
		  </geometry>
		  <material>
			<script>
			  <uri>file://media/materials/scripts/gazebo.material</uri>
			  <name>Gazebo/Red</name>
			</script>
		  </material>
		</visual>
		<collision name="base_link_collision">
		  <pose>0 0 0 0 0 0</pose>
		  <geometry>
			<box>
			  <size>0.08 0.08 0.10</size>
			</box>
		  </geometry>
		  <surface>
			<contact>
			  <ode>
				<max_vel>100.0</max_vel>
				<min_depth>0.001</min_depth>
			  </ode>
			</contact>
			<friction>
			  <ode>
				<mu>100000.0</mu>
				<mu2>100000.0</mu2>
			  </ode>
			</friction>
		  </surface>
		</collision>
	  </link>

	  <link name='bateria'>
	    <pose>-0.22 0 0.5 0 0 0</pose>
	    <inertial>
	  	<pose>0 0 0 0 0 0</pose>
	  	<mass>3.00</mass>
	  	<inertia>
	  	  <ixx>0.02</ixx>
	  	  <ixy>0</ixy>
	  	  <ixz>0</ixz>
	  	  <iyy>0.02</iyy>
	  	  <iyz>0</iyz>
	  	  <izz>0.02</izz>
	  	</inertia>
	    </inertial>
	    <visual name="bateria_visual">
	  	<pose>0 0 0 0 0 0</pose>
	  	<geometry>
	  	  <box>
	  		<size>0.12 0.25 0.30</size>
	  	  </box>
	  	</geometry>
	  	<material>
	  	  <script>
	  		<uri>file://media/materials/scripts/gazebo.material</uri>
	  		<name>Gazebo/Green</name>
	  	  </script>
	  	</material>
	    </visual>
	  </link>

	  <!--
      <plugin name="plugin_resistencia_ar_simples" filename="libfluid_resitance_plugin.so">
        <fluid_resistanceTopicName>/fluid_resistance</fluid_resistanceTopicName>
        <NameLinkToApplyResistance>base_link</NameLinkToApplyResistance>
        <rate>10.0</rate>
      </plugin> 
		-->

	<plugin name="euler_aero_plugin" filename="libeuler_aerodinamica_v1.so">
	  <robotNamespace>/propeller_test_model</robotNamespace>
	  <xyzOffset>0 0 0</xyzOffset> <!-- Altere para a posição desejada -->
	  
	  <!-- Tópicos para publicação de vento -->
	  <windForcePubTopic>vento/forca</windForcePubTopic>
	  <windSpeedPubTopic>vento/velocidade</windSpeedPubTopic>
	  
	  <!-- Definições de vento constante -->
	  <windSpeedMean>0.0</windSpeedMean> <!-- Velocidade média do vento (m/s) -->
	  <windSpeedVariance>1.0</windSpeedVariance> <!-- Variação da velocidade do vento (m/s) -->
	  <windDirection>1 0 0</windDirection> <!-- Direção do vento em coordenadas XYZ -->

	  <frontArea>2.0</frontArea> <!-- Direção da rajada em coordenadas XYZ -->
	  <dragCoeff>2.0</dragCoeff> <!-- Direção da rajada em coordenadas XYZ -->

	  <!-- Campo de vento customizado -->
	  <useCustomStaticWindField>false</useCustomStaticWindField>
	  
	  <windForceVariance>1.0</windForceVariance> <!-- Direção da rajada em coordenadas XYZ -->
	  <!-- Definições de rajadas de vento -->
	  <windGustStart>0.0</windGustStart> <!-- Tempo em que a rajada começa (s) -->
	  <windGustDuration>1.0</windGustDuration> <!-- Duração da rajada (s) -->
	  <windGustForceMean>5.0</windGustForceMean> <!-- Força média da rajada (N) -->
	  <windGustForceVariance>2.0</windGustForceVariance> <!-- Variação da força da rajada (N) -->
	  <windGustDirection>1 0 0</windGustDirection> <!-- Direção da rajada em coordenadas XYZ -->
	  <!-- Link que será afetado pelo vento -->
	  <linkName>base_link</linkName> <!-- Substitua por nome real do link -->
	  
	  <!-- ID do frame para mensagens -->
	  <frameId>world</frameId>
	</plugin>

	<!-- Inclusão do plugin euler_batt_plugin -->
	<plugin name="euler_batt_plugin" filename="libeuler_aerodinamica_v1_batt_plugin.so">
		<!-- Tipo de bateria: 'Welion', 'LiPo', 'LiIon' ou outro definido no plugin -->
		<batteryType>Welion</batteryType>

		<!-- Número de células em série (S) -->
		<cellsInSeries>14</cellsInSeries>

		<!-- Número de células em paralelo (P) -->
		<cellsInParallel>3</cellsInParallel>

		<!-- Nome do link onde a massa da bateria será atribuída -->
		<linkName>bateria</linkName>

		<!-- Tópico ROS onde a corrente consumida será recebida -->
		<currentTopic>/battery/current</currentTopic>

		<!-- Tópico ROS onde a tensão disponível será publicada -->
		<voltagePubTopic>/battery/voltage</voltagePubTopic>

		<!-- Tópico ROS onde o estado da bateria será publicado -->
		<batteryStatePubTopic>/battery/state</batteryStatePubTopic>
	</plugin>

    </model>
  </world>
</sdf>
